<powershell>
# Script triggered by cluster_web_ui/views/remote_desktop_windows.py
# Edit dcv.conf
$Hostname = Invoke-RestMethod -uri http://169.254.169.254/latest/meta-data/hostname
$InstanceId = Invoke-RestMethod -uri http://169.254.169.254/latest/meta-data/instance-id
$DCVHostAltname = $Hostname.split(".")[0]
New-Item -Path "Microsoft.PowerShell.Core\Registry::\HKEY_USERS\S-1-5-18\Software\GSettings\com\nicesoftware\dcv\" -Name connectivity -Force
New-ItemProperty -Path "Microsoft.PowerShell.Core\Registry::\HKEY_USERS\S-1-5-18\Software\GSettings\com\nicesoftware\dcv\connectivity" -Name "web-url-path" -PropertyType "String" -Value "/$DCVHostAltname" -Force

# Change password for Admin user
$Password = ConvertTo-SecureString -String "%SOCA_USER_PASSWORD%" -AsPlainText â€“Force
$UserAccount = Get-LocalUser -Name "Administrator"
$UserAccount | Set-LocalUser -Password $Password

# Restart DCV service
Restart-Service -Name dcvserver
</powershell>

