<!DOCTYPE html>
<html lang="en">

<head>
     {% include 'common/header.html' %}
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
    <link rel="stylesheet" src="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css">

</head>

<body id="page-top">

  <div id="wrapper">
    {% include 'common/vertical_menu_bar.html' %}
    <div id="content-wrapper" class="d-flex flex-column">
      <div id="content">
          <br>
          <div class="container-fluid">
              {% include 'common/horizontal_menu_bar.html' %}
              <main role="main">
              {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages %}
                            {% for category, message in messages %}
                                <br>
                                {% if category == "success" %}
                                <div class="alert alert-success">
                                    <strong>{{ message | safe }} </strong>
                                </div>
                                {% else %}
                                 <div class="alert alert-danger">
                                    <strong>{{ message | safe }} </strong>
                                </div>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    {% endwith %}

                  <div class="row">
                  <div class="col-md-12">
                      <nav aria-label="breadcrumb">
                          <ol class="breadcrumb">
                              {% for folder_name,path in breadcrumb.items() %}
                              <li class="breadcrumb-item"><a href="/my_files?path={{ path }}">{{folder_name}}</a></li>
                              {% endfor %}
                          </ol>
                      </nav>
                  </div>
                  <div class="col-md-12">
                  // Upload section will be available here
                  <hr>
                  <style>
                      /* change size of search */
                      .dataTables_filter input { width: 500% }
                  </style>
                  <table id="list_files_table" class="table row-border" style="width:100%">
        <thead>
            <tr>
                <th>Type</th>
                <th>Name</th>

            </tr>
        </thead>
        <tbody>
          {% for folder_name, folder_location in folders.items() %}
              <tr>
                  <td> <i class="far fa-folder-open fa-2x"></i></td>
                  <td><a href="/my_files?path={{ folder_location }}">{{ folder_name }}</a></td>

              </tr>
          {% endfor %}
         {%  for file_name,file_data in files.items() %}
             <tr>
             <td>
                          {% if file_name.endswith('.png') or file_name.endswith('.jpg') or file_name.endswith('.jpeg') %}
                              <i class="far fa-file-image fa-2x"></i>
                          {% elif file_name.endswith('.zip') or file_name.endswith('.tgz') or file_name.endswith('.tar.gz') or file_name.endswith('.rar') or file_name.endswith('.7z') %}
                              <i class="far fa-file-archive fa-2x"></i>
                                {% elif file_name.endswith('.pdf') %}
                                   <i class="far fa-file-pdf fa-2x"></i>
                              {% elif file_name.endswith('.ppt') or file_name.endswith('.pptx') %}
                                   <i class="far fa-file-powerpoint fa-2x"></i>


                          {% else %}
                              <i class="far fa-file-code fa-2x"></i>
                          {% endif %}
             </td>
                 <td><a href="/download?uid={{ file_data.uid }}">{{ file_name }}</a> (<strong>{{ file_data.st_size }}</strong>) <br> Last Modified: {{ file_data.st_mtime }} </td>

              </tr>
                      {% endfor %}


        </tbody>

    </table>
                  <script>
                      $(document).ready(function() {
                          $('#list_files_table').DataTable({
                              "paging": false,
                              dom:"<'myfilter'f><'mylength'l>t",
                              language: {
                                  searchPlaceholder: "Search for a file or a folder",
                                  search: ""
                              },

                              fixedColumns: {
                                  heightMatch: 'none'
                              },
                          })
                      });
                  </script>





                  </div>








                  </div>


              </main>




              </div>
          </div>
      </div>

  </div>

  <a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
  </a>


    {% include 'common/footer.html' %}

</body>

</html>
